##### Project code:       Net-Zero Toolkit for modelling the financial impacts of low-carbon transition scenarios
##### Date of last edit:  28/01/2019
##### Code author:        Shyamal Patel
##### Description:        This script reads in unique geographies data reported in TR geographic segment data
#####                     and maps these to known region / country headings
##### Dependencies:       1.  Latest list of TR unique geographies: "2_Financial/2b_Geographic_exposure/Interim/Unique_geogs_data.rds"
#####                         Older files can be found in the ".../Dated/" folder

#--------------------------------------------------------------------------------------------------

##### SECTION 1 - Housekeeping and data read in ----

# Define master_folder and source utils file which contains useful functions
main_save_folder <- "2_Financial/2b_Geographic_exposure"
source("utils.R")

# Read in unique geographies dataset
unique_geographies_data <- readRDS("2_Financial/2b_Geographic_exposure/Interim/Unique_geogs_data.rds")

# Read in region-ISO code mapping
region_iso_code_data <- read_excel(input_source("ISO_code_and_regional_gdp.xlsx"), 
                                   sheet = "W3. Region ISO code table", range = "$A$8:$IC$212")

# Read in ISO code level GDP data (for revenue reallocation weights)
gdp_iso_code_data <- read_excel(input_source("ISO_code_and_regional_gdp.xlsx"),
                                sheet = "W4. GDP ISO code table", range = "$A$7:$C$211")

save_dated(gdp_iso_code_data, "GDP_by_ISO_data", folder = "Interim", csv = TRUE)

#--------------------------------------------------------------------------------------------------

##### SECTION 2 - Clean datasets in preparation for region-ISO code matching

region_iso_code_data2 <- region_iso_code_data %>%
  rename_all(.funs = funs(gsub(" ", "_", .))) %>%
  rename_all(.funs = funs(gsub(",", "", .))) %>%
  rename_all(.funs = funs(gsub("'", "", .))) %>%
  rename_all(.funs = funs(gsub("-", "", .))) %>%
  rename_all(.funs = funs(gsub("\\(", "", .))) %>%
  rename_all(.funs = funs(gsub("\\)", "", .)))

# Basic super regions (with intermediate regions defined as per UN Statistics Division)
region_iso_code_data3 <- region_iso_code_data2 %>%
  mutate(Africa = Northern_Africa + SubSaharan_Africa,
         Asia = Western_Asia + Central_Asia + Eastern_Asia + Southeastern_Asia + Southern_Asia,
         Australasia = Australia_and_New_Zealand + Melanesia + Micronesia + Polynesia,
         Europe = Eastern_Europe + Northern_Europe + Southern_Europe + Western_Europe,
         Latin_America = Latin_America_and_the_Caribbean,
         North_America = Northern_America)

# Switch to long format
region_iso_code_data4 <- region_iso_code_data3 %>%
  gather(key = "Region", value = "ISO_code_included", -(ISO_code:Country))

unique_mapped_regions <- unique(region_iso_code_data4$Region)

# Remove already mapped regions
unique_geographies_data2 <- unique_geographies_data %>%
  filter(!(region %in% unique_mapped_regions))

#--------------------------------------------------------------------------------------------------

##### SECTION 3 - Create new variables for unmapped regions - this list was identified using the 
#####             the Unique_geogs_data.rds file output by the Geog_data_cleaning script

# Beware that there will be some identically defined regions within
# each row (for the same company) - we should not subtract these from one another when solving the ISO code allocation problem
region_iso_code_data5 <- region_iso_code_data3 %>%
  mutate(`/Africa_Region/Western_Asia_Region` = Africa + Western_Asia,
         `/Belgium_Country` = Belgium,
         Abroad = World,
         `ACH&Eastern_Europe` = Germany + Austria + Switzerland + Eastern_Europe, #ACH should read DACH based on annual report (DEU, AUT, CHE) https://www.gea.com/en/binaries/2016.03.10.%20GEA%20Annual%20Report%202015_tcm11-30988.pdf
         Africa. = Africa,
         `Africa/Mediterranean_Basin` = Africa + Southern_Europe,
         `Africa/Middle_East` = Africa + Middle_East,
         `Africa/Oceania` = Africa + Australasia,
         `Africa_&_middle_east` = Africa + Middle_East,
         `Africa_&_Middle_East` = Africa + Middle_East,
         `Africa_&_Middle_East_Region` = Africa + Middle_East,
         Africa__Middle_East__India = Africa + Middle_East + India,
         Africa_and_middle_east = Africa + Middle_East,
         Africa_and_MiddleEast = Africa + Middle_East,
         Africa_and_Oceania = Africa + Australasia,
         Africa_Asia_Australia = Africa + Asia + Australasia,
         Africa_Australia_and_Oceania = Africa + Australasia,
         Africa_Central_and_South_America = Africa + Latin_America,
         Africa_Middle_East = Africa + Middle_East,
         Africa_Region = Africa,
         Africa_Regions = Africa,
         Ahold_USA = United_States,
         All_countires_other_than_Switzerland_Russia_Italy_and_Nig = World - Switzerland - Russian_Federation - Italy - Nigeria, #Nigeria not Niger (company is COCA COLA HBC)
         All_foreign_countries = World,
         All_Other = World,
         All_other = World,
         All_other_Countries = World,
         All_other_countries = World,
         All_Other_Countries = World,
         All_Other_Europe = Europe,
         All_other_Foreign. = World,
         All_Other_Regions = World,
         All_Others = World,
         Alliances_and_Goodwill = World,
         Allianz_Worldwide_Partners = World,
         Allied_Medical = United_Kingdom, #Alliance Medical (UK based) was bought by the listed company, https://www.alliancemedical.co.uk/news/alliance-medical-acquired-by-life-healthcare
         AlliedBarton = United_States, #Part of Allied Universal (US based): https://en.wikipedia.org/wiki/Allied_Universal
         ALMEA = World - Europe - North_America, #Interpret based on regional breakdown here: http://investors.coty.com/phoenix.zhtml?c=251569&p=irol-newsArticle&ID=2315734
         Amazon_Web_Services = World,
         America = United_States,
         `America_&_Other` = World,
         America_and_Asia_Pacific_countries_and_others = World,
         America_Region = United_States,
         American_Region = United_States,
         Americas = North_America + Latin_America,
         `Americas_&_Other` = World,
         Americas_excl._USA = Americas - United_States,
         Americas_excluding_United_States = Americas - United_States,
         `Americas_Excluding_US_&_Canada` = Americas - United_States - Canada,
         Americas_other = Americas,
         Americas_other_than_U.S. = Americas - United_States,
         Americas_Other_than_U.S. = Americas - United_States,
         Americas_Region = Americas,
         Americas_RegionUnited_States_Country = Americas,
         AmericasIncluding_USA = Americas,
         `AndeanEcuador_&_Peru` = Ecuador + Peru,
         Aomen_zh_special_administrative_area = China, #Company is Shanghai Tunnel Engineering (SHAI TUN ENGR)
         APAC = Asia + Australasia, # APAC = Asia Pacific
         APEA = Asia + Australasia + Europe + United_States + Middle_East, # ANZ Bank (reporter) website says Asia Pacific, Europe and America, including Middle East (http://media.corporate-ir.net/media_files/irol/96/96910/ANZ/2010Review/operations/apea_region/index.html)
         APJC = APAC, #Asia Pacific, Japana and China https://www.acronymfinder.com/APJC.html
         `Arabian_Peninsula&Europe_&_Middle_East_&_Africa_EMEA_Regi` = Europe + Middle_East + Africa, #All Arabian peninsular countries fall under Middle East
         `Argentina_&_Other` = World,
         Armenia_Country = World,
         ASEAN = Brunei_Darussalam + Cambodia + Indonesia + Lao_PDR + Malaysia + Myanmar + Philippines + Singapore + Thailand + Vietnam, # ASEAN member countries list (http://asean.org/asean/asean-member-states/)
         `ASEAN_&_South_Asia` = ASEAN + Southern_Asia,
         `Asia&Africa_excl._South_Korea_China` = Asia + Africa - Korea_Rep. - China,
         `Asia&Oceania` = APAC,
         `Asia/_Pacyfic_North` = APAC, #Reporting company lists Asia-Pacific North, and Asia-Pacific South - assign to APAC
         `Asia/_Pacyfic_South` = APAC, #Reporting company lists Asia-Pacific North, and Asia-Pacific South - assign to APAC
         `Asia/Africa` = Asia + Africa,
         `Asia/Australia` = APAC,
         `Asia/China/Oceania` = APAC,
         `Asia/Middle_East/PacificOceania` = APAC + Middle_East,
         `Asia/Oceania` = APAC,
         `Asia/Oceania/Undetermined_Geography` = World,
         `Asia/Other` = World,
         `Asia/Other_PacificOceanic_Countries` = APAC,
         `Asia/Pacific` = APAC, # APAC = Asia Pacific
         `Asia/Pacific/Far_East` = APAC,
         `Asia/Pacific_&_Other` = World,
         `Asia/PacificOceania` = APAC,
         `Asia/PacificOceania/Africa` = APAC + Africa,
         `Asia_&_Australia` = APAC,
         `Asia_&_Middle_East` = Asia + Middle_East,
         `Asia_&_other` = World,
         `Asia_&_Rest_of_the_World` = World,
         `Asia_/_Rest_of_World` = World,
         `Asia_/Europe` = Asia + Europe,
         `Asia_/Oceania` = APAC,
         Asia__Oceania = APAC,
         Asia__Pacific = APAC,
         Asia_Africa = Asia + Africa,
         Asia_Africa_and_Europe = Asia + Africa + Europe,
         Asia_and_Africa = Asia + Africa,
         Asia_and_Asia_Pacific = APAC,
         Asia_and_Middle_East = Asia + Middle_East,
         Asia_and_Oceania = APAC,
         Asia_and_Oceania_Region = APAC,
         Asia_And_Other = World,
         Asia_and_other = World,
         Asia_and_Other = World,
         Asia_and_Other_Foreign = World,
         Asia_and_Others = World,
         Asia_and_Pacific = APAC,
         Asia_areas = Asia,
         Asia_Australasia_and_Middle_East = APAC + Middle_East,
         Asia_Australia = APAC,
         Asia_Australia_Africa = APAC + Africa,
         Asia_Australia_and_New_Zealand = APAC,
         Asia_Australia_and_Others = World,
         `Asia_ex._JapanChinaSouth_Korea` = Asia - Japan - China - Korea_Rep.,
         Asia_Except_South_Korea = Asia - Korea_Rep.,
         Asia_excluding_China = Asia - China,
         Asia_excluding_Hong_Kong = Asia - Hong_Kong_SAR_China,
         Asia_excluding_Hong_Kong_and_Mainland_China = Asia - Hong_Kong_SAR_China - China,
         Asia_excluding_Japan = Asia - Japan,
         Asia_excluding_Malaysia = Asia - Malaysia,
         Asia_excluding_Peoples_Republic_of_China = Asia - China,
         `Asia_Excluding_Singapore_China_&_HK` = Asia - China - Hong_Kong_SAR_China - Singapore,
         `Asia_exJapan_&_China` = Asia - Japan - China,
         `Asia_exJapan_&China` = Asia - Japan - China,
         Asia_exJapan_Region = Asia - Japan,
         Asia_exJapan_RegionChina_CountrySouth_Korea_Country = Asia - Japan - China - Korea_Rep.,
         Asia_exJapan_RegionThailand_Country = Asia - Japan - Thailand,
         Asia_exJapanChinaKorea = Asia - Japan - China - Korea_Rep.,
         Asia_Middle_East_and_Africa = Asia + Middle_East + Africa,
         Asia_Oceania = APAC,
         Asia_Oceania_and_Africa = APAC + Africa,
         Asia_other = Asia,
         Asia_Other_than_China = Asia - China,
         Asia_Pacific = APAC,
         Asia_pacific = APAC,
         `Asia_Pacific/_AMEA` = APAC + Middle_East + Africa, #Asia, Middle East and Africa (and Asia Pacific)
         `Asia_Pacific/APLA` = APAC,
         `Asia_Pacific_&_Japan` = APAC,
         `Asia_Pacific_&_Rest_of_Latin_America` = APAC + Latin_America,
         `Asia_Pacific_&_Rest_of_the_World` = World,
         Asia_Pacific_and_Latin_America_Region = APAC + Latin_America,
         Asia_Pacific_APAC = APAC,
         Asia_Pacific_Excluding_PRC = APAC - China,
         Asia_Pacific_including_South_Asia = APAC,
         `Asia_Pacific_Latin_America_Africa_&_Middle_East` = APAC + Latin_America + Africa + Middle_East,
         Asia_Pacific_Middle_East = APAC + Middle_East,
         Asia_Pacific_Other = APAC,
         Asia_Pacific_Others = APAC,
         Asia_Pacific_Region = APAC,
         Asia_Pacific_RegionMalaysia_Country = APAC - Malaysia,
         Asia_PacificJapan = Japan, #Asia Pacific(Japan) interpreted as Japan
         Asia_Pasific_and_Other = World,
         Asia_Region = Asia,
         `Asia_Region/Oceania_Region` = APAC,
         Asia_RegionChina_Country = Asia - China,
         Asia_RegionChina_CountryHong_Kong_Country = Asia - China - Hong_Kong_SAR_China,
         Asia_RegionChina_CountrySouth_Korea_Country = Asia - China - Korea_Rep.,
         Asia_RegionJapan_Country = Asia - Japan,
         Asia_without_China = Asia - China,
         `AsiaJapan_&_South_Korea_Country` = Asia - Japan - Korea_Rep.,
         Asian_and_Australia = APAC,
         Asian_Countries = Asia,
         Asian_Operations = Asia,
         Asian_Pacific = APAC,
         AsianPacific_excluding_China = APAC - China,
         AsiaPacific = APAC,
         `AsiaPacific/Rest_of_World` = World,
         `AsiaPacific_&_Indian_Subcontinent` = APAC,
         `AsiaPacific_&_Middle_East` = APAC + Middle_East,
         AsiaPacific_and_Other = World,
         AsiaPacific_Business = APAC,
         AsiaPacific_Islands = APAC,
         Asset_Management = World,
         `Asset_Management_&_Other` = World,
         `Asset_Mgm._and_Services:_Insurance_&_Other` = World,
         Atlantic = North_America + Europe,
         `Austalia_&_New_Zealand` = Australasia,
         Australasia_and_other = World,
         `Australia/Asia_Pacific` = APAC,
         `Australia/New_Zealand` = Australia_and_New_Zealand,
         `Australia/Pacific` = Australasia,
         `Australia_&_Asia` = Asia + Australia,
         `Australia_&_New_Zealand` = Australasia,
         `Australia_&_NZ` = Australasia,
         `Australia_&_Other` = World,
         `Australia_and_New_Zealand_&_Other` = World,
         Australia_Country = Australia,
         `Australia_Country/Indonesia_Country/New_Zealand_Country` = Australasia + Indonesia,
         `Australia_Country/United_Kingdom_Coun` = Australia + United_Kingdom,
         Australia_operation = Australia,
         `Austria_/Switzerland` = Austria + Switzerland,
         Austria_Country = Austria,
         Aviav_Investors = World,
         Bahamas = Bahamas_The,
         Baltic_Countries = Denmark + Estonia + Latvia + Finland + Germany + Lithuania + Poland + Russian_Federation + Sweden, #Broad definition taken from here: https://en.wikipedia.org/wiki/Baltic_region
         Baltic_States = Baltic_Countries,
         Baltic_States_Region = Baltic_Countries,
         Baltic_States_Russia_and_Poland = Baltic_Countries,
         Baltics = Baltic_Countries,
         Barbado = Barbados,
         `Belarus_&_Other` = World,
         `Belgium/Luxembourg` = Belgium + Luxembourg,
         `Belgium_&_Other` = World,
         `Belgium_/Luxembourg/Netherlands` = Belgium + Luxembourg + Netherlands,
         Belgium_and_Luxembourg = Belgium + Luxembourg,
         `Belgium_Country_&_Other` = World,
         Benelux = Belgium + Luxembourg + Netherlands,
         `Bermuda_&_Other` = World,
         `Brazil_&_Other` = World,
         `Brazil_&_Others` = World,
         Brazil_Country = Brazil,
         Brisbane = Australia,
         British_Virgin_Islands = `Virgin_Islands_U.S.`,
         Brunei = Brunei_Darussalam,
         `Bugis+_&_Other` = World, #Doesn't matter really - CAPITALAND reports no revenue under this region
         Bulgaria_Country = Bulgaria,
         California_state = United_States,
         CaliforniaCypress = United_States,
         Cambodia_Country = Cambodia,
         `Canada.` = Canada,
         `Canada/Europe` = Canada + Europe,
         `Canada/Latin_America` = Canada + Latin_America,
         `Canada/United_States` = Canada + United_States,
         `Canada_&_Other` = World,
         `Canada_&_United_Kingdom` = Canada + United_Kingdom,
         Canada_and_central_europe = Canada + Austria + Croatia + Czech_Republic + Germany + Hungary + Liechtenstein + Poland + Slovak_Republic + Slovenia + Switzerland, # Central Europe definition: https://en.wikipedia.org/wiki/Central_Europe#Other_countries_and_regions
         Canada_and_Mexico = Canada + Mexico,
         Canada_and_Other = World,
         Canada_and_United_States = Canada + United_States,
         Canada_Country = Canada,
         Canada_Domestic = Canada,
         Canada_Export = Canada,
         `Canada_Mexico_China_&_Other` = World,
         Canadian_Operations = Canada,
         `Caribbean.` = Caribbean,
         `Caribbean/Central_America` = Caribbean + Central_America,
         `Caribbean_&_Other` = World,
         Caribbean_and_Central_America = Caribbean + Central_America,
         Caribbean_basin = Caribbean,
         Caribbean_Island = Caribbean,
         Caribbean_Islands = Caribbean,
         `Carribean_&_Other` = World,
         Cayman_Islands = Caribbean,
         CEEMENA = Austria + Croatia + Czech_Republic + Germany + Hungary + Liechtenstein + Poland + Slovak_Republic + Slovenia + Switzerland + Eastern_Europe + Middle_East + Northern_Africa, #Definition is Central and Eastern Europe, Middle East, and North Africa: http://www.ihhhealthcare.com/about-overview.php
         `Central/Eastern_Europe` = Austria + Croatia + Czech_Republic + Germany + Hungary + Liechtenstein + Poland + Slovak_Republic + Slovenia + Switzerland + Eastern_Europe, # Central Europe definition: https://en.wikipedia.org/wiki/Central_Europe#Other_countries_and_regions
         `Central/South_America` = Latin_America,
         `Central_&_Eastern_Europe` = Austria + Croatia + Czech_Republic + Germany + Hungary + Liechtenstein + Poland + Slovak_Republic + Slovenia + Switzerland + Eastern_Europe, # Central Europe definition: https://en.wikipedia.org/wiki/Central_Europe#Other_countries_and_regions
         `Central_&_South_America` = Latin_America,
         Central_Activities = World, #Not essential - no revenue reported under this region
         `Central_America/Other_South_American_Countries` = Latin_America,
         `Central_America/South_America` = Latin_America,
         Central_America_and_South_America = Latin_America,
         Central_and_Latin_America = Latin_America,
         Central_and_Other_Costs = World, #Not essential - no revenue reported under this region
         Central_and_other_items = World,
         Central_and_South_America = Latin_America,
         Central_and_south_america = Latin_America,
         Central_and_south_America = Latin_America,
         Central_and_Southeastern_Europe = Austria + Croatia + Czech_Republic + Germany + Hungary + Liechtenstein + Poland + Slovak_Republic + Slovenia + Switzerland + # Central Europe as defined at above location
           Albania + Bosnia_and_Herzegovina + Bulgaria + Croatia + Greece + Kosovo + Macedonia_FYR + Montenegro + Romania + Serbia + Slovenia, # South Eastern Europe definition: https://en.wikipedia.org/wiki/Southeast_Europe
         Central_and_southern_Europe = Austria + Croatia + Czech_Republic + Germany + Hungary + Liechtenstein + Poland + Slovak_Republic + Slovenia + Switzerland + Southern_Europe, # Central Europe definition: https://en.wikipedia.org/wiki/Central_Europe#Other_countries_and_regions,
         Central_and_Southern_Europe = Central_and_southern_Europe,
         Central_Europe = Austria + Croatia + Czech_Republic + Germany + Hungary + Liechtenstein + Poland + Slovak_Republic + Slovenia + Switzerland, # Central Europe definition as above
         `Central_Europe_&_Eastern_Europe` = Central_Europe + Eastern_Europe,
         Central_Europe_and_Eastern_Europe = Central_Europe + Eastern_Europe,
         Central_European_Countries = Central_Europe,
         `Central_Funding_&_Eliminations` = World, #Not essential - no revenue reported under this region
         `Centrica_Storage_&_Other` = World, #Centrica reporting no revenue under this region
         `Cerro_Matoso_&_Other` = World, #Other = global as always (South32 company)
         Channel_Islands = United_Kingdom,
         `Changyi_High_Speed_&_Other` = World, #Other = global as always - no revenue reported under this region
         `Chile_&_Other` = World,
         Chile_Country = Chile,
         `China&_SouthEast_Asia` = China + Southeastern_Asia,
         `China/Asia` = Asia,
         `China/Hong_Kong` = China + Hong_Kong_SAR_China,
         `China/Taiwan` = China,
         `China_&_Central_Asia` = China + Central_Asia,
         `China_&_Hong_Kong` = China + Hong_Kong_SAR_China,
         `China_&_Other` = World,
         `China_&_south_Asia` = China + Southern_Asia,
         `China_+_Hong_Kong_+Taiwan` = China + Hong_Kong_SAR_China,
         China_and_Hong_Kong = China + Hong_Kong_SAR_China,
         China_and_Mongolia = China + Mongolia,
         China_and_other_Asia = Asia,
         China_Country = China,
         China_ex_Hong_Kong_and_Macau_Country = China,
         China_Excluding_Hong_Kong = China - Hong_Kong_SAR_China,
         China_including_Hong_Kong = China + Hong_Kong_SAR_China,
         China_Including_Hong_Kong = China + Hong_Kong_SAR_China,
         China_including_Hong_Kong_Macau_and_Taiwan = China + Hong_Kong_SAR_China + Macao_SAR_China, # Taiwan does not exist in WB GDP data
         China_Inland = China,
         China_Mainland = China,
         China_Taiwan_and_Hong_Kong = China + Hong_Kong_SAR_China,
         `ChinaAsia_Region/Oceania_Region` = APAC,
         ChinaIncluding_Hong_Kong = China + Hong_Kong_SAR_China,
         ChinaMainland = China,
         Chinese_Mainland = China,
         CIS = Azerbaijan + Belarus + Kazakhstan + Kyrgyz_Republic + Armenia + Moldova + Russian_Federation + Tajikistan + Uzbekistan, # CIS is the Commonwealth of Independent States, definition: https://en.wikipedia.org/wiki/Commonwealth_of_Independent_States#Member_states
         `CIS_&_North_America` = CIS + North_America,
         Cloud_Computing = World,
         Colombia_Country = Colombia,
         Columbia = Colombia, # Assume typo (Colombia)
         Commercial_Banking_rest_of_World = World,
         `Commercial_Prop._Dev._Europe` = ifelse(OECD == 1 & Europe == 1, 1, 0),
         `Commercial_Prop._Dev.US` = United_States,
         Commercial_Property_Development_Other_Areas = World,
         Congo = Congo_Rep.,
         Consolidation__Asia_pacific = APAC,
         Consolidation__Europe = Europe,
         Consolidation__Germany = Germany,
         Consolidation_America = United_States,
         `Constr._Sweden` = Sweden,
         Construction_US = United_States,
         ConstructionOther_Areas = World,
         Continental_Africa = Africa,
         Continental_Europe = Europe,
         Continental_US = United_States,
         Contract_Manufacturing = World,
         Converse = World,
         Corporate_net_financing_charges_and_tax = World, #Not essential - no revenue reported under this region
         Cost_rica = Costa_Rica,
         Costa_rica = Costa_Rica,
         Costa_Rica_Country = Costa_Rica,
         `Croatia_&_Other` = World,
         Croatia_Country = Croatia,
         `Crude_Oil_Petrol._and_Petrochem._Prod.__Russia` = Russian_Federation,
         `Crude_Oil_Petrol._and_Petrochem._ProductsForeign_Countries` = World,
         `Crude_OilPetrol.&Petrochem_Prod.CIS_countries_ex.Russia` = CIS,
         Cyprus_Country = Cyprus,
         `Czech_Republic_&_Other` = World,
         Czech_Republic_Country = Czech_Republic,
         DACH = Germany + Austria + Switzerland, #DACH = Germany (DEU), Austria (AUT) and Switzerland (CHE)
         Danish_General_Insurance = Denmark,
         Delhaize_America = United_States,
         Denmark_Country = Denmark,
         Developed_Europe = ifelse(OECD == 1 & Europe == 1, 1, 0), # Assume OECD intersection with Europe is rough approximation
         `Developing_Europe_&_CIS` = Europe - Developed_Europe + CIS, # CIS is the Commonwealth of Independent States, definition: https://en.wikipedia.org/wiki/Commonwealth_of_Independent_States#Member_states
         Developing_Markets = NonOECD,
         Digital = World,
         Discontinue = World,
         Discontinue_assets = World,
         Discontinued = World,
         Discontinued_operation = World,
         Discontinued_Operation = World,
         Discontinued_Operations = World,
         Discontinued_operations = World,
         Distribution_Centers = World,
         Divested_Business = World,
         `Domestic_U.S_and_Canada` = United_States + Canada,
         Dominican = Dominican_Republic,
         `Dominican_Republic_&_Other` = World,
         `E.U.` = European_Union,
         EAME = Europe + Middle_East + Africa, # Assume typo (EMEA)
         East_Asia = Eastern_Asia,
         East_Mediterranean = Cyprus + Greece + Lebanon + Israel + Turkey + Egypt_Arab_Rep. + Jordan, #Definition taken from here https://en.wikipedia.org/wiki/Eastern_Mediterranean#Countries
         East_Timor = TimorLeste,
         `East_Timor_/_TimorLeste_Country` = TimorLeste,
         Eastern_Asia_excluding_Japan = Eastern_Asia - Japan,
         Eastern_China = China,
         `Eastern_Europe/Central_Asia` = Eastern_Europe + Central_Asia,
         Eastern_Europe_broadly_defined_Region = Eastern_Europe,
         `Eastern_Europe_Middle_East_&_Africa` = Eastern_Europe + Middle_East + Africa,
         Eastern_Europe_Middle_East_Asia_and_Australia = Eastern_Europe + Middle_East + APAC,
         Eastern_Europe_Region = Eastern_Europe,
         Eastern_Mediterranean = East_Mediterranean,
         `Ecuador_&_Other` = World,
         Ecuadr = Ecuador,
         EEMEA = Eastern_Europe + Middle_East + Africa,
         Egypt = Egypt_Arab_Rep.,
         `Egypt_&_Other` = World,
         Egypt_Country = Egypt_Arab_Rep.,
         `Electricity_Generation_&_Other` = World, #No revenue reported anyway
         Elsewhere = World,
         EMA = Europe + Middle_East + Africa, # Defined as EMEA: http://ir.flowserve.com/phoenix.zhtml?c=79032&p=irol-reportsAnnual
         EMEA = Europe + Middle_East + Africa,
         `EMEA/Asia_Pacific` = EMEA + APAC,
         `EMEA_excl._Switzerland` = EMEA - Switzerland,
         EMEA_excl_Italy = EMEA - Italy,
         EMEA_Latam = EMEA + Latin_America,
         EMEA_without_Germany = EMEA - Germany,
         EMEIA = Europe + Middle_East + India + Africa, #Defined as EMEA + India: http://www.fujitsu.com/mk/about/fts/
         Emerging_Countries_and_Asia_Pacific = NonOECD + APAC,
         Emerging_Markets = NonOECD,
         Emerging_markets = NonOECD,
         EMLA = Europe + Middle_East + Africa + Latin_America, # Europe, Middle East, Africa and Latin America excluding Mexico: http://press.covestro.com/news.nsf/id/a9c7ta-covestro-makes-a-strong-start-to-2016
         England = United_Kingdom,
         Enlink = United_States, #Midstream company owned by Devon Energy based in the US: https://www.bloomberg.com/research/stocks/private/snapshot.asp?privcapid=247475973
         Equator_Re = World, #Reinsurance company - treated as global
         esidential_Development_Pther_Areas = World,
         EU = European_Union,
         EU_Countries = European_Union,
         EU_Countries_excluding_Germany = European_Union - Germany,
         `EU_excl._Sweden` = European_Union - Sweden,
         Eurasia = Europe + Asia,
         Eurasias = Eurasia,
         Euro_Zone = Austria + Belgium + Cyprus + Estonia + Finland + France + Germany + Greece + Ireland + Italy + Latvia + Lithuania + Luxembourg +
           Malta + Netherlands + Portugal + Slovak_Republic + Slovenia + Spain, # Country list taken from here: https://en.wikipedia.org/wiki/Eurozone
         Euro_Zone_Region = Euro_Zone,
         `Europe.` = Europe,
         `Europe/Africa` = Europe + Africa,
         `Europe/Africa/CIS` = Europe + Africa + CIS, # See above for CIS definition
         `Europe/Africa/Middle_East` = EMEA,
         `Europe/Asia` = Europe + Asia,
         `Europe/C.I.S./Middle_East/Africa` = EMEA + CIS,
         `Europe/CIS/Africa` = Europe + CIS + Africa, # See above for CIS definition
         `Europe/EMEA` = EMEA,
         `Europe/Middle_East` = Europe + Middle_East,
         `Europe/Middle_East/Africa` = EMEA,
         `Europe/Middle_East_and_Africa` = EMEA,
         `Europe/South_Africa` = Europe + South_Africa,
         `Europe/United_States` = Europe + United_States,
         `Europe_&_Africa` = Europe + Africa,
         `Europe_&_Africa_&Middle_East` = EMEA,
         `Europe_&_Americas` = Europe + Americas,
         `Europe_&_Asia_Pacific` = Europe + APAC,
         `Europe_&_FSU` = Europe + Estonia + Latvia + Lithuania + Kazakhstan + Kyrgyz_Republic + Tajikistan + Turkmenistan + Uzbekistan + Belarus + Moldova + 
           Ukraine + Russian_Federation + Armenia + Azerbaijan + Georgia, # Former Soviet Union state definition: https://en.wikipedia.org/wiki/Post-Soviet_states#Country_comparison,
         `Europe_&_Georgia_Region/Africa_&_Middle_East_Region` = Europe + Georgia + Africa + Middle_East,
         `Europe_&_Middle_East_&_Africa_EMEA` = EMEA,
         `Europe_&_Middle_East_&_Africa_EMEA_Region` = EMEA,
         `Europe_&_Other` = World,
         `Europe_&_other` = World,
         `Europe_/Africa_/Middle_East` = EMEA,
         `Europe_/Middle_East` = Europe + Middle_East,
         Europe__Total = Europe,
         Europe_Africa_and_Middle_East = EMEA,
         Europe_Americas_and_Oceania = Europe + Americas + Australasia,
         Europe_and_Africa = Europe + Africa,
         Europe_and_CIS = Europe + CIS,
         Europe_and_Israel = Europe + Israel,
         Europe_and_Other = World,
         Europe_and_Other_Regions = World,
         Europe_and_South_America = Europe + South_America,
         `Europe_C.I.S._Africa_Middle_East` = Europe + CIS + Africa + Middle_East,
         Europe_except_France = Europe - France,
         `Europe_excl._Norway` = Europe - Norway,
         `Europe_excl._UK` = Europe - United_Kingdom,
         Europe_excl_Scandinavia = Europe - Denmark - Norway - Sweden,
         `Europe_exclud._France` = Europe - France,
         Europe_Excluding_France = Europe - France,
         Europe_excluding_France = Europe - France,
         Europe_excluding_Germany = Europe - Germany,
         Europe_excluding_Sweden = Europe - Sweden,
         Europe_excluding_the_UK = Europe - United_Kingdom,
         Europe_excluding_United_Kingdom = Europe - United_Kingdom,
         Europe_IMF_region = Europe,
         `Europe_Middle_East_&_Africa` = EMEA,
         Europe_Middle_East_Africa = EMEA,
         Europe_Middle_East_Africa__other_countries = World, #EMEA already defined in this row - no revenue under this category anyway
         Europe_Middle_East_and_Africa = EMEA,
         Europe_Middle_East_and_Africa_EMEA = EMEA,
         Europe_Middle_East_and_Africa_Estimates_Data_Load_Region = EMEA,
         EUROPE_minus_France = Europe - France,
         Europe_other = Europe,
         Europe_Other = Europe,
         Europe_Others = Europe,
         Europe_Region = Europe,
         Europe_region = Europe,
         `Europe_Region/Americas_Region` = Europe + Americas,
         Europe_RegionGermany_Country = Europe - Germany,
         Europe_RegionGermany_CountryFrance_Country = Europe - Germany - France,
         Europe_RegionPoland_Country = Europe - Poland,
         `Europe_Region&Middle_East_Region` = Europe + Middle_East,
         `Europe_the_Middle_East_&_Africa` = EMEA,
         Europe_the_Middle_East_and_Africa = EMEA,
         `Europe` = Europe,
         `EuropeAfrica_&_Middle_East` = EMEA,
         European = Europe,
         `European_&_Americas` = Europe + Americas,
         European_Countries = Europe,
         European_Markets = Europe,
         European_Operations = Europe,
         European_Region = Europe,
         `EuropeMiddle_East_&_Africa` = EMEA,
         EuropeMiddle_East_and_Africa = EMEA,
         EuropeMiddle_EastAfrica_Region = EMEA,
         EuropeRegion = Europe,
         Export = World,
         Export_Sales = World,
         Exports_and_International = World,
         External = World,
         Far_East = China + Hong_Kong_SAR_China + Macao_SAR_China + Japan + Korea_Rep. + Mongolia + Brunei_Darussalam + Cambodia
         + TimorLeste + Malaysia + Lao_PDR + Indonesia + Myanmar + Singapore + Philippines + Thailand + Vietnam, #Far East countries list taken from here: https://www.worldatlas.com/articles/which-are-the-countries-of-the-far-east.html
         `Far_East/Asia` = Asia,
         Far_East_and_other_ASEAN_Countries = Far_East + ASEAN, #Only referenced once - fine to treat as such (reporting revenue in China and Singapore directly)
         FEG_Group = Far_East, #Treat Far East Global Group as being part of Far East: https://www.reuters.com/finance/stocks/company-officers/CCOHY.PK
         `Finance_&_Investments_and_Others` = World,
         Finland_and_Baltics = Baltic_Countries + Finland,
         Finland_and_Iceland = Finland + Iceland,
         Finland_and_Scandinavia = Denmark + Norway + Sweden + Finland,
         `Finland_Country_&_Other` = World,
         Foreign = World,
         `Foreign.` = World,
         `Foreign..` = World,
         Foreign_Contries = World,
         Foreign_countries = World,
         Foreign_Countries = World,
         Foreign_country = World,
         Foreign_Entities = World,
         Foreign_Operations = World,
         Foreign_Principally_United_Kingdom = World,
         Foreigns = World,
         Foriegn = World,
         Former_Sowiet_Union_Countries = Estonia + Latvia + Lithuania + Kazakhstan + Kyrgyz_Republic + Tajikistan + Turkmenistan + Uzbekistan + Belarus + Moldova + 
           Ukraine + Russian_Federation + Armenia + Azerbaijan + Georgia, # Former Soviet Union state definition: https://en.wikipedia.org/wiki/Post-Soviet_states#Country_comparison
         `France/_DOMTOM` = France,
         `France_&_Other` = World,
         `France_&_UK` = France + United_Kingdom,
         `France_/Monaco` = France + Monaco,
         France_and_Southern_Europe = France + Southern_Europe,
         France_Country = France,
         Gauteng = South_Africa,
         General = World,
         German_Speaking_Countries_and_Central_and_Eastern_Europe = Germany + Austria + Switzerland + Liechtenstein + Luxembourg + Belgium + Italy + Slovak_Republic + Central_Europe + Eastern_Europe, #https://www.quora.com/Which-countries-in-the-world-speak-German-as-the-native-tongue
         GermanSpeaking = Germany + Austria + Switzerland + Liechtenstein + Luxembourg + Belgium + Italy + Slovak_Republic, #https://www.quora.com/Which-countries-in-the-world-speak-German-as-the-native-tongue
         `GERMANY/AUSTRIA` = Germany + Austria,
         `Germany/Italy/Spain` = Germany + Italy + Spain,
         Germany_ = Germany,
         `Germany_&_Other` = World,
         `Germany_&_Austria_&_Other` = World,
         Germany_and_Northern_Europe = Germany + Northern_Europe,
         Germany_Country = Germany,
         Global = World,
         Global_Brand_Divisions = World,
         Global_Corporate = World,
         Global_Insurance_Lines_and_Anglomarkets = World,
         Global_Operations_and_Corporate_Expenses = World,
         Great_britain = United_Kingdom,
         Great_Britain = United_Kingdom,
         Great_China = China,
         Greater_Asia = Asia,
         Greater_China = China,
         `Greater_China_&_North_asia` = China + Russian_Federation, #North Asia consists of parts of Siberia
         Greater_China_Country = China,
         Greater_China_Region = China,
         `Greece_&_European_Union` = European_Union,
         Greece_and_Western_Europe = Greece + Western_Europe,
         Group_Business = World,
         Group_Other = World,
         Group_Services = World,
         Growth_Markets = World,
         Growth_markets = World,
         `Guatemala_&_Other` = World,
         Guernsey_United_Kingdom = United_Kingdom,
         Gulf_Council_Cooperation_Countries = Saudi_Arabia + Kuwait + United_Arab_Emirates + Qatar + Bahrain + Oman, # Gulf cooperation council defined as here: https://www.britannica.com/topic/Gulf-Cooperation-Council
         GWA = United_States, #Greater Washington Area: https://www.transurban.com/content/dam/investor-centre/04/2017-Annual-Report.pdf
         High_Growth_Markets = World,
         `HK_Macau_TW_&_Other_Foreigns` = World,
         Holland = Netherlands,
         Hong_Kong = Hong_Kong_SAR_China,
         `Hong_Kong/China/Macao` = Hong_Kong_SAR_China + China + Macao_SAR_China,
         `Hong_Kong_&_Macau` = Hong_Kong_SAR_China + Macao_SAR_China,
         `Hong_Kong_&_Other` = World,
         Hong_Kong_and_Macau = Hong_Kong_SAR_China + Macao_SAR_China,
         Hong_Kong_and_overseas_countries = World,
         Hong_Kong_Country = Hong_Kong_SAR_China,
         `Hong_Kong_Country/Macau_Country/Taiwan_Country` = Hong_Kong_SAR_China + Macao_SAR_China + China,
         `Hong_Kong_Macau_&_Taiwan` = Hong_Kong_SAR_China + Macao_SAR_China + China,
         Hong_Kong_Macau_and_Taiwan = Hong_Kong_SAR_China + Macao_SAR_China,
         `Hungary_&_Other` = World,
         Hungary_Country = Hungary,
         Iberia = Spain + Portugal + Andorra,
         `Iberia_&_Latin_America` = Spain + Portugal + Andorra + Latin_America,
         Iberian_Peninsula_Region = Iberia,
         Iberian_Penisula = Iberia,
         Iceland_Country = Iceland,
         In_India = India,
         `India_&_Other` = World,
         India_and_china = India + China,
         India_Country = India,
         `Indonesia_&_PNG` = Indonesia + Papua_New_Guinea,
         Indonesia_Country = Indonesia,
         `Industrial/OfficeUnited_Kingdom_&_Other` = World, #No revenue reported in region
         `Industrial_and_Safety_&_Other` = World, #No revenue reported in region
         `Insurance_and_Reinsurance__Northbridge_&_Other` = World, #No revenue reported in region
         International_Tansacion = World,
         International = World,
         INTERNATIONAL = World,
         International_Business_segment = World,
         international_businesses = World,
         International_Carriers_and_Shared_Services = World,
         International_Class_III = World,
         International_Commerce = World,
         International_Lead_Markets = World,
         International_Markets = World,
         International_Operation = World,
         International_operations = World,
         International_Operations = World,
         International_Operations. = World,
         International_RCS = World,
         International_revenue = World,
         InternationalAsia = Asia,
         InternationalEurope = Europe,
         Internationalforeign = World,
         Iran = Iran_Islamic_Rep.,
         `Ireland_&_other` = World,
         `Ireland_&_Other` = World,
         Ireland_Country = Ireland,
         ISC = World,
         Isle_of_Man = United_Kingdom,
         Israel_Country = Israel,
         ITALY = Italy,
         `Italy_&_Other` = World,
         Italy_Country = Italy,
         Italy_Spain_and_other = World,
         Ivory_Coast = Cote_dIvoire,
         Jakarta = Indonesia,
         `Japan/Asia` = Asia,
         `Japan/South_Korea` = Japan + Korea_Rep.,
         `Japan_&_Korea` = Japan + Korea_Rep.,
         `Japan_&_Other` = World,
         Japan_Country = Japan,
         Jawa = Indonesia,
         `KalimantanSulawesi_&_Maluku` = Indonesia, #Subregions of Indonesia
         `Kenya_&_Other` = World,
         Korea = Korea_Rep.,
         `Korea_&_Other` = World,
         Korea_Democratic_Peoples_Republic_of = Korea_Rep., #Company is based in South Korea - assume this is an error and they mean South Korea
         Korea_Republic_of = Korea_Rep.,
         KoreaSouth = Korea_Rep.,
         Lao = Lao_PDR,
         Las_Vegas_Operations = United_States,
         Lasalle_Investment_Management_Services = United_States, #Subsidiary company is based in the US
         LATAM = Latin_America,
         latin_America = Latin_America,
         `Latin_America.` = Latin_America,
         `Latin_America/Canada` = Latin_America + Canada,
         `Latin_America_&_canada` = Latin_America + Canada,
         `Latin_America_&_Canada` = Latin_America + Canada,
         `Latin_America_&_Other` = World,
         `Latin_America_&_the_Caribbean` = Latin_America + Caribbean,
         `Latin_America_&Asia` = Latin_America + Asia,
         Latin_America__North = Latin_America - Bolivia - Paraguay - Uruguay - Argentina - Chile, # Defining Latin America South and North as here: http://ri.ambev.com.br/arquivos/Ambev_LAS_Deck_Final.pdf
         Latin_America__South = Bolivia + Paraguay + Uruguay + Argentina + Chile,
         Latin_America_and_Caribbean = Latin_America + Caribbean,
         Latin_America_and_Caribbean_except_Chile = Latin_America + Caribbean - Chile,
         Latin_America_and_Mexico = Latin_America + Mexico,
         Latin_America_and_Other = World,
         Latin_America_Caribbean_and_other = World,
         Latin_America_Region = Latin_America,
         Latin_America_without_Brazil = Latin_America - Brazil,
         Latin_American = Latin_America,
         Latin_American_Operations = Latin_America,
         `Luxembourg_&_Other` = World,
         Luxembourg_Country = Luxembourg,
         Macao = Macao_SAR_China,
         Macau = Macao_SAR_China,
         Macau_Country = Macao_SAR_China,
         Macau_operations = Macao_SAR_China,
         Macedonia = Macedonia_FYR,
         Main_Land_of_China = China,
         Mainland_China = China,
         `Mainland_China_&_Hong_Kong` = China + Hong_Kong_SAR_China,
         `Mainland_China_&_Taiwan` = China,
         Mainland_China_Hong_Kong_and_Taiwan = China + Hong_Kong_SAR_China + Macao_SAR_China,
         Mainland_China_including_Macau = China + Macao_SAR_China,
         Mainland_PRC = China,
         MALAYSIA = Malaysia,
         `Malaysia/Singapore` = Malaysia + Singapore,
         Malaysia_Country = Malaysia,
         MCI = World, #Molson Coors International (treat as Global)
         MEAA = Middle_East + Africa + Asia,
         Mediterranean_Middle_East_and_Africa = Spain + France + Monaco + Italy + Slovenia + Croatia + Bosnia_and_Herzegovina + Montenegro + Albania + Greece
         + Turkey + Lebanon + Israel + Egypt_Arab_Rep. + Libya + Tunisia + Algeria + Morocco + Malta + Cyprus + Middle_East + Africa, #List of Mediterranean countries: https://en.wikipedia.org/wiki/Mediterranean_Sea#Coastal_countries
         Melbourne = Australia,
         MENA = Middle_East + Northern_Africa,
         `Mexico_&_Central_America` = Mexico + Central_America,
         `Mexico_&_Other` = World,
         Mexico_and_Brazil = Mexico + Brazil,
         Mexico_Country = Mexico,
         Mexico_South_America_Australia_and_other = World,
         Mexico_Telmex = Mexico,
         MFS = United_States, #MFS Investment Management is a US-based subsidiary of SunLife: https://en.wikipedia.org/wiki/MFS_Investment_Management
         MidAtlantic = Atlantic, #Treat as Atlantic (North America and Europe)
         `Middle_East&Asia` = Middle_East + Asia,
         `Middle_East/Africa` = Middle_East + Africa,
         `Middle_East/Asia` = Middle_East + Asia,
         `Middle_East/Turkey` = Middle_East + Turkey,
         `Middle_East_&_Africa` = Middle_East + Africa,
         `Middle_East_&_India` = Middle_East + India,
         Middle_East_Africa = Middle_East + Africa,
         Middle_East_Africa_and_India = Middle_East + Africa + India,
         Middle_East_and_Africa = Middle_East + Africa,
         Middle_East_and_India. = Middle_East + India,
         Middle_East_and_North_Africa = Middle_East + Northern_Africa,
         Middle_East_Asia = Middle_East + Asia,
         Middle_East_Region = Middle_East,
         `Middle_EastEurope_&_Africa` = EMEA,
         MidstreamUnited_States = United_States,
         `MIS_&_Other` = World, #No revenue reported in this region
         `Mongolia_&_Other` = World,
         Morocco_Country = Morocco,
         Mozambican = Mozambique,
         NAFTA = North_America + Mexico,
         Nepal_Country = Nepal,
         Netherlands_Country = Netherlands,
         New_Markets = World,
         New_Other_Foreign = World,
         New_york = United_States,
         New_York = United_States,
         `New_Zealand_&_Fiji` = New_Zealand + Fiji,
         New_Zealand_Country = New_Zealand,
         `New_Zealand_Country_&_Other` = World,
         `New_ZealandAustralia_&_Americas` = New_Zealand + Australia + Americas,
         New_Zealandd = New_Zealand,
         Nigeria_Country = Nigeria,
         Non__United_states = World - United_States,
         Non__US = World - United_States,
         Non_Distributed_Operating_Income = World,
         Non_US = World - United_States,
         NonChina = World - China,
         NonCore = World,
         NonFrance = World - France,
         `NonU.S.` = World - United_States,
         NonUnited_kingdom = World - United_Kingdom,
         NonUnited_States = World - United_States,
         NonUS = World - United_States,
         Nordic = Denmark + Finland + Iceland + Norway + Sweden + Greenland, #Definition of Nordics: https://en.wikipedia.org/wiki/Nordic_countries
         Nordic_Countries = Nordic,
         Nordic_Region = Nordic,
         Nordic_States_Region = Nordic,
         `North&South&Central_America` = Americas,
         North_America. = North_America,
         `North_America/Canada/Mexico` = North_America + Mexico,
         `North_America/Central_America/South_America` = Americas,
         `North_America_&_South_America_excluding_United_States` = Americas - United_States,
         North_America_and_Latin_America_Estimat = Americas,
         North_America_and_Latin_America_Estimates_Data_Load_Region = Americas,
         North_America_and_Latin_America_other = Americas,
         North_America_exBermuda_Region = North_America - Bermuda,
         North_America_excluding_United_States = North_America - United_States,
         North_America_excluding_US = North_America - United_States,
         `North_America_U.S._and_Canada` = North_America,
         North_American = North_America,
         North_American_Free_Trade_Agreement_NAFTA_region = North_America + Mexico,
         North_American_Region = North_America,
         North_and_Cental_America = North_America + Central_America,
         North_And_Central_Europe = Northern_Europe + Central_Europe,
         North_and_South_America = Americas,
         North_Asia = Russian_Federation,
         North_East_Asia = China + Japan + Mongolia + Korea_Rep., # North East Asia definition (NB No GDP data for North Korea): https://en.wikipedia.org/wiki/Northeast_Asia
         North_Sea = United_Kingdom + Norway + Denmark + Germany + Netherlands + Belgium + France, # North Sea countries definition: https://en.wikipedia.org/wiki/North_Sea
         NorthEast_Asia = North_East_Asia, # North East Asia definition set out above
         `Northern_&_Central_America` = North_America + Central_America,
         Northern_America = North_America,
         `Northern_America.` = North_America,
         `Northern_America/South_America` = North_America + Latin_America,
         `Northern_America_/Europe` = North_America + Europe,
         `Northern_America_/Oceania` = North_America + Australasia,
         `Northern_America_excl._USA` = North_America - United_States,
         Northern_America_Region = North_America,
         Northern_America_RegionUnited_States_Country = North_America - United_States,
         Northern_AmericaUnited_States = North_America - United_States,
         Northern_central_and_eastern_Europe = Northern_Europe + Central_Europe + Eastern_Europe,
         Northern_China = China,
         `Northern_Europe_&_Central_Asia` = Northern_Europe + Central_Asia,
         `Northern_Europe_&_Central_Asia_&_Other` = World,
         Northwestern_Europe = Ireland + United_Kingdom + Belgium + Netherlands + Germany + Norway + Sweden + Iceland, #Northwestern Europe definition: https://en.wikipedia.org/wiki/Northwestern_Europe#Geographic_definitions
         `Norway_&_Other` = World,
         Norway_Country = Norway,
         Norwegian_General_Insurance = Norway,
         Nothern_Europe = Northern_Europe,
         NSESA = Denmark + Finland + Iceland + Norway + Sweden + Southern_Europe + South_America, # NSESA definition: https://www.cgi.com/sites/default/files/pdf/cgi-2016-annual-information-form.pdf; Nordic countries definition: https://en.wikipedia.org/wiki/Nordic_countries
         `O.C.D.E._Countries` = OECD,
         `O.E.C.D._Countries` = OECD,
         Oceania = Australasia,
         `Oceania_&_Other` = World,
         Oceania_Region = Australasia,
         OECD_Countries = OECD,
         Office_Outside_France = World,
         Offshore_West_Africa = Western_Africa,
         Ohers = World,
         Orange_Bank = France, #Orange Bank launched in France
         Othe_CEE_Countries = Central_Europe + Eastern_Europe, #Central and Eastern European countries
         Other = World,
         other = World,
         OTher = World,
         `Other.` = World,
         `Other_&_Other` = World,
         Other_activities = World,
         Other_Activity = World,
         Other_Africa = Africa,
         `Other_Africa/Middle_East_Countries` = Africa + Middle_East,
         Other_African_Countries = Africa,
         Other_AMAP = Africa + Middle_East + APAC, #Definition from Vodafone here: https://www.fiercewireless.com/europe/vodafone-appoints-former-orange-exec-vivek-badrinath-as-ceo-for-amap-region
         Other_America = Americas,
         Other_Americas = Americas,
         Other_Area = World,
         Other_Areas = World,
         `Other_Areas/Regions` = World,
         Other_Asean_Countries = ASEAN,
         Other_Asia = Asia,
         `Other_Asia_Africa_&_Australasia` = Asia + Africa + Australasia,
         Other_Asia_Countries = Asia,
         Other_Asia_Markets = Asia,
         Other_Asia_Pacific = APAC,
         other_asia_pacific = APAC,
         Other_Asia_Pacific_Region = APAC,
         Other_Asian_Countries = Asia,
         Other_Asian_countries = Asia,
         Other_Asian_region = Asia,
         Other_AsiaPacific = APAC,
         Other_assets = World,
         Other_Business = World,
         `Other_Businesses_&_Other` = World,
         Other_Canadian_Operations = Canada,
         Other_Challengers = World,
         Other_Counrtries = World,
         Other_Countires = World,
         Other_Countries = World,
         Other_countries = World,
         other_countries = World,
         `other_Countries.` = World,
         `Other_countries.` = World,
         Other_countries_and_regions = World,
         Other_countries_and_unallocated = World,
         `Other_countries_excl._PRC_HK_SNG` = World - China - Hong_Kong_SAR_China,
         `Other_countries_excl._PRC_SNG_FRN` = World - China - France,
         `Other_countries_in_Africa/Middle_East` = Africa + Middle_East,
         Other_countries_in_South_East_Asia = Southeastern_Asia,
         Other_Countries_in_South_East_Asia = Southeastern_Asia,
         Other_Country = World,
         Other_country = World,
         `Other_coutries_in_Asia/Australia` = APAC,
         Other_Developed_Markets = OECD,
         Other_EAME = EAME, #EMEA - assumed to be a typo
         Other_Eastern_European_Countries = Eastern_Europe,
         Other_EMEA = EMEA,
         Other_Emerging_Countries = NonOECD,
         Other_Emerging_Markets = NonOECD,
         Other_EU = European_Union,
         Other_EU_Countries = European_Union,
         Other_EU_Member_States = European_Union,
         Other_Euorpe = Europe,
         Other_Europe = Europe,
         Other_Europe_and_Africa = Europe + Africa,
         Other_Europe_Countries = Europe,
         `Other_Europe_Middle_East_&_Africa` = Europe + Middle_East + Africa,
         Other_European = Europe,
         Other_European_Countries = Europe,
         Other_European_countries = Europe,
         Other_European_operations = Europe,
         Other_European_Union = European_Union,
         `Other_Financial_market_sector_&_Other` = World,
         Other_Foreign = World,
         Other_foreign = World,
         `Other_Foreign/Asia` = World,
         `Other_Foreign/Intercompany_Eliminations` = World,
         `Other_Foreign/International` = World,
         Other_Foreign_Area = World,
         Other_Foreign_countires = World,
         Other_foreign_countries = World,
         Other_Foreign_countries = World,
         Other_Foreign_Countries = World,
         Other_foreign_Countries = World,
         other_foreign_countries = World,
         Other_Foreign_Country = World,
         Other_Foreign_primarily_Europe = World,
         Other_Foreigns = World,
         Other_Foriegn = World,
         Other_GCC_Countries = Gulf_Council_Cooperation_Countries, #GCC = Gulf Council Cooperation countries defined above
         Other_Geography = World,
         Other_GOODS = World,
         Other_HK = Hong_Kong_SAR_China,
         Other_International = World,
         other_international = World,
         other_International = World,
         Other_international = World,
         Other_international_market = World,
         Other_International_Operations = World,
         Other_international_operations = World,
         `Other_Intl._Corporate_&_Marketing` = World,
         Other_Latin_America = Latin_America,
         other_Latin_America = Latin_America,
         Other_Latin_American = Latin_America,
         other_location = World,
         Other_Locations = World,
         Other_Markets = World,
         Other_matters = World,
         Other_MENA = Middle_East + Northern_Africa,
         Other_Middle_Eastern_Countries = Middle_East,
         Other_Nations = World,
         Other_Nordic_Countries = Nordic,
         Other_North_America = North_America,
         Other_North_American_Countries = North_America,
         Other_North_and_Latinmerica_Markets = Americas,
         Other_Northern_America = North_America,
         Other_OECD_Countries = OECD,
         Other_Operations = World,
         Other_operations = World,
         Other_Overseas_Markets = World,
         Other_parts_of_the_PRC = China,
         Other_Region = World,
         other_region = World,
         Other_Regions = World,
         Other_regions = World,
         Other_Remaining_Areas = World,
         Other_revenue = World,
         Other_Revenue = World,
         `Other_SEA_&_Other` = World,
         Other_South_American_Countries = South_America,
         Other_Southern_Europe = Southern_Europe,
         Other_than_Canada = World,
         Other_WECA = Western_Africa + Angola + Cameroon + Central_African_Republic + Chad + Congo_Dem._Rep. + #Central Africa definition: https://en.wikipedia.org/wiki/Central_Africa#List_of_Central_African_countries
           Equatorial_Guinea + Gabon + Congo_Rep. + Sao_Tome_and_Principe, #MTN group define WECA as Western and Central Africa: https://www.telegeography.com/products/commsupdate/articles/2015/12/04/mtn-group-announces-new-operating-structure-reshuffles-senior-management/
         Other_Western_Europe = Western_Europe,
         Other_Western_European_Countries = Western_Europe,
         OtherexlcAmericasAsiaEuropeOceania = World - Americas - Asia - Europe - Australasia,
         OtherForeign = World,
         OtherOceania = Australasia,
         Others = World,
         others = World,
         `Others.` = World,
         Others_Countries = World,
         Others_Excluding_PRC_Vietnam_and_Indonesia = World - China - Vietnam - Indonesia,
         Others_Excluding_US_Europe_and_PRC = World - United_States - Europe - China,
         Others_Foreign = World,
         Others_Foreigns = World,
         Others_Mostly_Asia = Asia,
         OUS = World - United_States, # Outside United States
         Outside_India = World - India,
         outside_india = World - India,
         `Outside_India.` = World - India,
         Outside_Indonesia = World - Indonesia,
         Outside_Mainland_China = World - China,
         Outside_Malaysia = World - Malaysia,
         Outside_North_America = World - North_America,
         Outside_of_Israel = World - Israel,
         Outside_of_Mainland_China = World - China,
         Outside_PRC = World - China,
         Outside_United_States = World - United_States,
         Outside_US = World - United_States,
         Over_seas = World,
         Oversea = World,
         oversea = World,
         Overseas = World,
         `Overseas.` = World,
         Overseas_countries_and_regions = World,
         Overseas_market = World,
         Overseas_Operations = World,
         Pacific = APAC,
         Pacific_Basin = Russian_Federation + China + Hong_Kong_SAR_China + Macao_SAR_China + Japan + Korea_Rep. + Brunei_Darussalam + Cambodia + TimorLeste + Indonesia
         + Malaysia + Philippines + Singapore + Thailand + Vietnam + Australasia + North_America + Mexico + Central_America
         + Chile + Colombia + Ecuador + Peru, #Definition from here: https://en.wikipedia.org/wiki/Pacific_Rim#List_of_countries_on_the_Pacific_Rim
         Pacific_Rim = Pacific_Basin,
         PacificOceania = APAC,
         Pakistan_Country = Pakistan,
         `Panama/Cayman_Islands` = Panama,
         `Panama_&_Other` = Panama,
         `Papua_New_Guinea_&_Other` = World,
         Papua_NewGuinea = Papua_New_Guinea,
         Paraguay_Country = Paraguay,
         Parent_Company_and_ROW = World,
         Peoples_Replublic_of_China = China,
         Peoples_Republic_of_China = China,
         `Peru_&_Other` = World,
         `Philippines_&_Other` = World,
         Philippines_Country = Philippines,
         Philippines_Domestic = Philippines,
         Phillippines = Philippines,
         Poland_and_Central_Europe = Poland + Central_Europe,
         Poland_Country = Poland,
         `Portugal_&_Other` = World,
         Portugal_Country = Portugal,
         PRC = China,
         PRC_and_Taiwan = China,
         PRC_including_HongKong_Macau_and_Taiwan = China + Hong_Kong_SAR_China + Macao_SAR_China,
         `Property_Under_Construction_&_Other` = World,
         `Real_State_Activities__ANF_&_Other` = World,
         Region_China = China,
         `Regional_Hong_Kong_Macau_&_Taiwan` = China + Hong_Kong_SAR_China,
         Reinsurance = World,
         Remaining_Markets = World,
         Republic_of_China = China,
         Republic_of_Ireland = Ireland,
         `Residential_Dev._Sweden` = Sweden,
         resr_of_Europe_United_Kingdom_CountryWorld_RegionUnit = Europe - United_Kingdom,
         Rest_of_Africa = Africa,
         Rest_of_America = United_States,
         Rest_of_Americas = Americas,
         `Rest_of_Americas_&_Other` = World,
         Rest_of_APAC = APAC,
         `Rest_of_ASEAN_&_Australia` = ASEAN + Australia,
         Rest_of_Asia = Asia,
         Rest_Of_Asia = Asia,
         `Rest_of_Asia/Pacific` = APAC,
         `Rest_of_Asia_Middle_East_&_Africa` = Asia + Middle_East + Africa,
         Rest_of_Asia_Pacific = APAC,
         Rest_of_Asia_Pacific1 = APAC,
         `Rest_of_Central_&_Eastern_Europe` = Central_Europe + Eastern_Europe,
         Rest_of_EMEA = EMEA,
         Rest_of_EU = European_Union,
         Rest_of_Europe = Europe,
         Rest_Of_Europe = Europe,
         `Rest_of_Europe_&_Other` = World,
         Rest_of_Europe_Middle_East_and_Africa = Europe + Middle_East + Africa,
         Rest_of_European_Union = European_Union,
         Rest_of_greater_China = China,
         `Rest_of_Latin_America_&_Other` = World,
         Rest_of_North_America = North_America,
         Rest_of_North_and_South_America = Americas,
         Rest_of_Scandinavia = Denmark + Norway + Sweden,
         Rest_of_the_Asia = Asia,
         Rest_of_the_Countries = World,
         Rest_of_the_Europe = Europe,
         Rest_of_the_World = World,
         Rest_of_the_world = World,
         Rest_of_The_World = World,
         REST_OF_THE_WORLD = World,
         Rest_Of_The_World = World,
         `Rest_of_the_world.` = World,
         `Rest_of_the_World.` = World,
         `Rest_of_the_World_&_consolidation` = World,
         `Rest_of_the_world_&_Other` = World,
         Rest_of_the_World_and_Consolidation = World,
         Rest_of_Western_Europ = Western_Europe,
         Rest_of_Western_Europe = Western_Europe,
         Rest_of_World = World,
         Rest_of_world = World,
         Rest_World = World,
         Restof_the_world = World,
         Restofthe_world = World,
         RestofWorld = World,
         Rests_of_the_World = World,
         Romania_Country = Romania,
         ROW = World,
         Russia = Russian_Federation,
         `Russia/Georgia` = Russian_Federation + Georgia,
         `Russia/GUS` = Russian_Federation + CIS, #Assume CIS (Adidas is respondent, and annual reports refer to Russia/CIS as a region): https://www.adidas-group.com/media/filer_public/a3/fb/a3fb7068-c556-4a24-8eea-cc00951a1061/2016_eng_gb.pdf
         `Russia/Other_CIS` = Russian_Federation + CIS,
         Russia_and_the_CIS = Russian_Federation + CIS,
         Russia_Country = Russian_Federation,
         Samoa_Country = Samoa,
         Saudi_Arabia_Country = Saudi_Arabia,
         `Saudi_Arabia_Country_&_Other` = World,
         Scandinavia = Denmark + Norway + Sweden, #List of companies: https://en.wikipedia.org/wiki/Scandinavia
         Scandinavia_Region = Scandinavia,
         Scotland = United_Kingdom,
         Serbia_Country = Serbia,
         `Singapore/Marina_Bay_sands` = Singapore,
         `Singapore_&_Other` = World,
         Singapore_Country = Singapore,
         `Singapore_Country/South_Korea_Country` = Singapore + Korea_Rep.,
         Slovakia = Slovak_Republic,
         Slovakia_Country = Slovak_Republic,
         Slovenia_Country = Slovenia,
         `South/Central_America` = Latin_America,
         South_Africa_Country = South_Africa,
         `South_America/Central_America` = Latin_America,
         `South_America/Europe` = South_America + Europe,
         `South_America/Mexico` = South_America + Mexico,
         `South_America/Other_Central_American_Countries` = South_America + Central_America,
         South_America_Africa_Middle_East = South_America + Africa + Middle_East,
         South_America_RegionBrazil_Country = South_America - Brazil,
         South_American_Countries = South_America,
         South_and_Central_America = Latin_America,
         South_and_South_East_Asia = Southern_Asia + Southeastern_Asia,
         South_Asia = Southern_Asia,
         South_East_Asia = Southeastern_Asia,
         `South_East_Asia_&_Oceania` = Southeastern_Asia + Australasia,
         South_East_Europe = Albania + Bosnia_and_Herzegovina + Bulgaria + Croatia + Greece + Kosovo + Macedonia_FYR + Montenegro + Romania + Serbia + Slovenia + Turkey, #Definition based on: https://en.wikipedia.org/wiki/Southeast_Europe
         South_Korea = Korea_Rep.,
         South_Korea_Country = Korea_Rep.,
         South_West_Pacific = Australasia,
         SouthEast_Asia = Southeastern_Asia,
         Southeast_Asia = Southeastern_Asia,
         `Southeast_Asia_&_Taiwan` = Southeastern_Asia + China,
         Southeast_Asia_and_others = World,
         Southeast_Asian_Countries = Southeastern_Asia,
         SouthEast_Europe = South_East_Europe,
         Southeastern_Europe = South_East_Europe,
         Southeastern_Europe_Middle_East_and_Africa = South_East_Europe + Middle_East + Africa,
         `Southern_/Western_Europe_India_Africa_&_Middle_East` = Southern_Europe + Western_Europe + India + Africa + Middle_East,
         `Southern_Africa_&_Other_Emerging_Markets` = NonOECD,
         `Southern_Asia_/Oceania` = Southern_Asia + Australasia,
         Southern_China = China,
         Southern_Cone = Argentina + Chile + Paraguay + Uruguay, # Southern cone definition from America Movil: https://www.reuters.com/finance/stocks/companyProfile/AMX
         Southern_East_Asia = Southeastern_Asia,
         Southern_Europe_and_Africa = Southern_Europe + Africa,
         `Southern_Europe_Region/Northern_Europe_Region/Eastern_Eu` = Southern_Europe + Northern_Europe + Eastern_Europe,
         Southernwest_Europe = Spain + Portugal + Andorra + Monaco + France, #Southwestern Europe defined using: https://en.wikipedia.org/wiki/Category:Southwestern_European_countries
         `Spain/Portugal` = Spain + Portugal,
         `Spain/Portugal/Andorra` = Spain + Portugal + Andorra,
         `Spain_&_Other` = World,
         `Spain_&_Portugal` = Spain + Portugal,
         Spain_and_Gibraltar = Spain,
         Spain_Country = Spain,
         Srilanka = Sri_Lanka,
         `Steel_Products_Business_&_Other` = World,
         Sub_Sahara_African_Countries = SubSaharan_Africa,
         Subsidiaries = World,
         Sumatera = Indonesia, #Part of Indonesia
         Surabaya = Indonesia, #Part of Indonesia
         Sweden_Country = Sweden,
         Swedish_General_Insurance = Sweden,
         `Switzerland_&_Other` = World,
         Switzerland_Country = Switzerland,
         Sydney = Australia,
         Taiwan = China,
         Taiwan_Country = China,
         Taiwan_province = China,
         Taiwan_Republic_of_China = China,
         `Technology_&_Other` = World,
         `Tenant_Reimbursement_&_Other` = World,
         Tesco_Bank = United_Kingdom,
         THAILAND = Thailand,
         `Thailand_&_Other` = World,
         Thailand_Country = Thailand,
         Thames_Valley_and_the_Regions = United_Kingdom,
         The_Americas = Americas,
         The_Bahamas = Bahamas_The,
         The_Lao_PDR = Lao_PDR,
         The_Mainland = China,
         The_Netherlands = Netherlands,
         `The_Netherlands_&_Other` = World,
         The_Peoples_Republic_of_China = China,
         The_PRC = China,
         `The_Russian_Federation_&_CIS` = Russian_Federation + CIS,
         The_United_Kingdom = United_Kingdom,
         `The_United_States_U.S.` = United_States,
         Total_Americas = Americas,
         Total_Asia = Asia,
         `Total_Asia_&_Australia` = APAC,
         Trinidad = Trinidad_and_Tobago,
         `Turkey_&_Other` = World,
         Turkey_Country = Turkey,
         Turkey_operations = Turkey,
         Turkish_Republic_of_Northern_Cyprus = Cyprus,
         `U.K` = United_Kingdom,
         `U.K.` = United_Kingdom,
         `U.K._and_others` = World,
         `U.S` = United_States,
         `U.S.` = United_States,
         `U.S._and_Canada` = United_States + Canada,
         `U.S._operations` = United_States,
         `U.S._U.S._Commercial_and_State_Governament` = United_States,
         `U.S.A` = United_States,
         `U.S.A.` = United_States,
         `U.S_and_Canada` = United_States + Canada,
         UAE = United_Arab_Emirates,
         UCIA = United_Kingdom + Ireland + Africa, #Definition from Computershare: https://www.computershare.com/corporate/ucia
         `Uganda_Country_&_Other` = World,
         UK = United_Kingdom,
         `UK_&_Ireland` = United_Kingdom + Ireland,
         `UK_&_IRELAND` = United_Kingdom + Ireland,
         `UK_&_Ireland.` = United_Kingdom + Ireland,
         `UK_&_ROI` = United_Kingdom + Ireland,
         `UK_&Ireland` = United_Kingdom + Ireland,
         UK_and_Egypt = United_Kingdom + Egypt_Arab_Rep.,
         UK_and_Europe = Europe,
         UK_and_Ireland = United_Kingdom + Ireland,
         UK_and_USA = United_Kingdom + United_States,
         UK_Central_Eastern_Europe = United_Kingdom + Central_Europe + Eastern_Europe,
         UK_Operations = United_Kingdom,
         UK_operations = United_Kingdom,
         Unite_States = United_States,
         United_Arab_Emirate = United_Arab_Emirates,
         `United_Arab_Emirates_Country_&_Other` = World,
         united_kingdom = United_Kingdom,
         `United_Kingdom/Ireland` = United_Kingdom + Ireland,
         `United_Kingdom_&_Europe` = Europe,
         `United_Kingdom_&_Ireland` = United_Kingdom + Ireland,
         `United_Kingdom_&_Other` = World,
         United_Kingdom_and_Ireland = United_Kingdom + Ireland,
         United_Kingdom_and_other = World,
         United_Kingdom_Country = United_Kingdom,
         `United_Kingdom_Country_&_Other` = World,
         United_Sates_of_America = United_States,
         `United_States.` = United_States,
         `United_States/Canada` = United_States + Canada,
         `United_States/North_America` = North_America,
         `United_States_&_Canada` = United_States + Canada,
         `United_States_&_Other` = World,
         `United_States_&_Puerto_Rico` = United_States + Puerto_Rico,
         United_States_and_Australia = United_States + Australia,
         United_States_and_Canada = United_States + Canada,
         United_States_and_Puerto_Rico = United_States + Puerto_Rico,
         United_States_Coun = United_States,
         United_States_Country = United_States,
         `United_States_Country_&_Other` = World,
         United_States_of_America = United_States,
         United_states_of_America = United_States,
         `United_States_of_America_&_Other` = World,
         United_States_of_America_and_other_countries = World,
         United_States_Operations = United_States,
         United_States_Sovereign = United_States,
         United_StatesCanada_and_Latin_America = United_States + Canada + Latin_America,
         US = United_States,
         US_and_Bahamas = United_States + Bahamas_The,
         US_and_Canada = United_States + Canada,
         US_Operations = United_States,
         USA = United_States,
         `USA/Canada` = United_States + Canada,
         `USA_&_Canada` = United_States + Canada,
         USA_and_Canada = United_States + Canada,
         USA_and_North_America = North_America,
         Venezuela = Venezuela_RB,
         vietnam = Vietnam,
         Vietnam_Country = Vietnam,
         Virgin_Islands = Virgin_Islands_U.S.,
         Vodacom = South_Africa, #Vodacom based in ZAF: https://en.wikipedia.org/wiki/Vodacom
         West_Africa = Western_Africa,
         `West_Africa_Region/Ghana` = Western_Africa + Ghana,
         `West_Asia/Africa` = Western_Asia + Africa,
         West_European_Countries = Western_Europe,
         Western_Cape = South_Africa, #Reporting company also based in ZAF: https://en.wikipedia.org/wiki/Western_Cape
         Western_europe = Western_Europe,
         `Western_Europe&Northern_Europe` = Western_Europe + Northern_Europe,
         Western_Europe_broadly_defined_Region = Western_Europe,
         `Western_Europe_excl._Germany` = Western_Europe - Germany,
         Western_Europe_Middle_East_and_Africa = Western_Europe + Middle_East + Africa,
         Western_Europe_Region = Western_Europe,
         `Western_Hemisphere_excluding_U.S.` = Americas + Europe - United_States,
         `Whole/Retail_Sales_&_Other` = World,
         Within_India = India,
         `World_excl._Europe_USA_Canada` = World - Europe - United_States - Canada,
         `World_excl._France_&_Europe` = World - Europe,
         `World_excl.South_Korea_Country` = World - Korea_Rep.,
         World_exJapan = World - Japan,
         World_exJapan_Country = World - Japan,
         World_exJapan_Region = World - Japan,
         World_exJapan_RegionSwaziland_Country = World - Japan - Swaziland,
         World_exJapanex_United_States = World - Japan - United_States,
         `World_Exl._Indonesia_Country` = World - Indonesia,
         World_RegionAustralia_Country = World - Australia,
         World_RegionChina_Country = World - China,
         World_RegionSouth_Korea_Country = World - Korea_Rep.,
         World_RegionSouth_Korea_CountryAsi = World - Asia,
         World_RegionSouth_Korea_CountryPhilippines_CountryK = World - Korea_Rep. - Philippines - Kazakhstan,
         World_rest = World,
         World_United_Kingdom_United_States_CountryEurope_Regio = World - United_Kingdom - United_States - Europe,
         WorldAmericas_Japan = World - Americas - Japan,
         WorldUnited_Kingdom_United_States_China_Country = World - United_Kingdom - United_States - China,
         Worldwide_Structures = World,
         Wynn_Boston_Harbor = United_States
  )

# Remove any double counted ISO codes (for instance, Africa and Middle East, Asia and Middle East overlap above)
region_iso_code_data6 <- region_iso_code_data5 %>%
  mutate_at(.vars = vars(`/Africa_Region/Western_Asia_Region`:Wynn_Boston_Harbor),
            .funs = funs(case_when(. > 1 ~ 1,
                                   . < 0 ~ 0,
                                   TRUE ~ .)))

save_dated(region_iso_code_data6, "Mapped_geog_categories_wide", folder = "Interim", csv = TRUE)

region_iso_code_data7 <- region_iso_code_data6 %>%
  gather(key = "Region", value = "Inclusion", -(ISO_code:Country)) %>%
  select(Region, everything())

save_dated(region_iso_code_data7, "Mapped_geog_categories", folder = "Interim", csv = TRUE)